% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/operator-average.R
\name{average_spectra}
\alias{average_spectra}
\title{Average Spectra by Group}
\usage{
average_spectra(spectra, na.rm = TRUE)
}
\arguments{
\item{spectra}{A \code{ruffs_spectra_collection_grouped} object created by
\code{\link[=group_spectra]{group_spectra()}}.}

\item{na.rm}{Logical. If \code{TRUE} (default), NA values are removed before
computing means. If \code{FALSE}, any NA values will propagate to the result.}
}
\value{
A \code{ruffs_spectra_collection} object containing one averaged spectrum
per group. Each spectrum is a dataframe with columns:
\itemize{
\item \code{wavelength}: Wavelength values (nm)
\item \code{spectra}: Mean spectral values across all group members
}
The collection retains metadata from the input (instrument, data_type,
wavelength_range) and adds:
\itemize
\item \code{averaged}: Logical flag set to \code{TRUE}
\item \code{group_sizes}: Named integer vector with number of spectra
averaged in each group
}
}
\description{
Computes the mean spectrum for each group in a grouped spectral collection.
This reduces multiple replicate measurements to a single representative
spectrum per group.
}
\details{
The function assumes all spectra within a group share identical wavelength
grids (as would be the case after using \code{\link[=interpolate_spectra]{interpolate_spectra()}}).

Group names become the names of the averaged spectra in the output
collection. For example, if groups are "site1_oak" and "site1_pine", the
output collection will contain spectra named "site1_oak" and "site1_pine".
}
\examples{
\dontrun{
# Process and group spectra
spectra <- svcreader("path/to/files") |>
  interpolate_spectra() |>
  stitch_spectra() |>
  correct_spectra() |>
  group_spectra(separator = "_", position = 2

# Compute group averages
averaged <- average_spectra(spectra)

# View result
print(averaged)
names(averaged$spectra)  

# Access individual averaged spectrum
averaged$spectra[["site1_oak"]]

# Check how many spectra were averaged per group
attr(averaged, "group_sizes")
}

}
\seealso{
\code{\link[=group_spectra]{group_spectra()}} for creating grouped collections,
\code{\link[=summarise_spectra]{summarise_spectra()}} for computing additional statistics (SD, SE, etc.)
}
